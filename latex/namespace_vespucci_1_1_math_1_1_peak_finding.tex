\hypertarget{namespace_vespucci_1_1_math_1_1_peak_finding}{}\section{Vespucci\+:\+:Math\+:\+:Peak\+Finding Namespace Reference}
\label{namespace_vespucci_1_1_math_1_1_peak_finding}\index{Vespucci\+::\+Math\+::\+Peak\+Finding@{Vespucci\+::\+Math\+::\+Peak\+Finding}}


A namespace for math functions relating to peak detection and counting.  


\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
V\+E\+S\+P\+U\+C\+C\+I\+\_\+\+E\+X\+P\+O\+RT arma\+::uvec {\bfseries Find\+Peak\+Centers} (const arma\+::vec \&signal, const arma\+::vec \&abscissa, std\+::list$<$ arma\+::umat $>$ \&ridges, arma\+::uword first\+\_\+scale, arma\+::uword last\+\_\+scale, arma\+::uword search\+\_\+window, arma\+::uword min\+\_\+length, arma\+::uword max\+\_\+gap, const std\+::string \&max\+\_\+method)\hypertarget{namespace_vespucci_1_1_math_1_1_peak_finding_a4db4c2f1e08f6326157be8a7f90ec42b}{}\label{namespace_vespucci_1_1_math_1_1_peak_finding_a4db4c2f1e08f6326157be8a7f90ec42b}

\item 
V\+E\+S\+P\+U\+C\+C\+I\+\_\+\+E\+X\+P\+O\+RT arma\+::vec {\bfseries Deriv\+Gauss\+Kernel} (double abscissa\+\_\+step, arma\+::uword window\+\_\+size, arma\+::uword width, double height)\hypertarget{namespace_vespucci_1_1_math_1_1_peak_finding_a0226402354861e6de00beedcd2c5786e}{}\label{namespace_vespucci_1_1_math_1_1_peak_finding_a0226402354861e6de00beedcd2c5786e}

\item 
V\+E\+S\+P\+U\+C\+C\+I\+\_\+\+E\+X\+P\+O\+RT arma\+::vec {\bfseries Mexican\+Hat\+Kernel} (double abscissa\+\_\+step, arma\+::uword window\+\_\+size, arma\+::uword width, double height)\hypertarget{namespace_vespucci_1_1_math_1_1_peak_finding_a6c94bf49cd2c7b4de7ee3171a06fc2ea}{}\label{namespace_vespucci_1_1_math_1_1_peak_finding_a6c94bf49cd2c7b4de7ee3171a06fc2ea}

\item 
V\+E\+S\+P\+U\+C\+C\+I\+\_\+\+E\+X\+P\+O\+RT arma\+::uvec {\bfseries Find\+Intercepts} (const arma\+::vec \&signal)\hypertarget{namespace_vespucci_1_1_math_1_1_peak_finding_ab4a5eddad57d84fb16e79914df07785b}{}\label{namespace_vespucci_1_1_math_1_1_peak_finding_ab4a5eddad57d84fb16e79914df07785b}

\item 
V\+E\+S\+P\+U\+C\+C\+I\+\_\+\+E\+X\+P\+O\+RT arma\+::vec \hyperlink{namespace_vespucci_1_1_math_1_1_peak_finding_a3d5687d6ba8babb49689af636f28aae8}{Find\+Peaks} (arma\+::vec X, arma\+::vec dX, double sel, double threshold, arma\+::vec \&peak\+\_\+magnitudes)
\begin{DoxyCompactList}\small\item\em \hyperlink{namespace_vespucci_1_1_math_1_1_peak_finding_a3d5687d6ba8babb49689af636f28aae8}{Vespucci\+::\+Math\+::\+Peak\+Finding\+::\+Find\+Peaks} an implementation of the peakfinder arma\+::mat routine. \end{DoxyCompactList}\item 
V\+E\+S\+P\+U\+C\+C\+I\+\_\+\+E\+X\+P\+O\+RT arma\+::uvec {\bfseries Find\+Peak\+Positions} (arma\+::vec X, arma\+::vec dX, double sel, double threshold, arma\+::uvec \&local\+\_\+minima)\hypertarget{namespace_vespucci_1_1_math_1_1_peak_finding_a767c3537b74d0c61d6998204c3176b97}{}\label{namespace_vespucci_1_1_math_1_1_peak_finding_a767c3537b74d0c61d6998204c3176b97}

\item 
V\+E\+S\+P\+U\+C\+C\+I\+\_\+\+E\+X\+P\+O\+RT arma\+::mat \hyperlink{namespace_vespucci_1_1_math_1_1_peak_finding_a9f22a184fb69fb6ab32757fdd19e1ae7}{Find\+Peaks\+Mat} (arma\+::mat X, double sel, double threshold, arma\+::uword poly\+\_\+order, arma\+::uword window\+\_\+size, arma\+::mat \&peak\+\_\+magnitudes)
\begin{DoxyCompactList}\small\item\em \hyperlink{namespace_vespucci_1_1_math_1_1_peak_finding_a9f22a184fb69fb6ab32757fdd19e1ae7}{Vespucci\+::\+Math\+::\+Peak\+Finding\+::\+Find\+Peaks\+Mat} Performs Find\+Peaks on a spectra arma\+::matrix. \end{DoxyCompactList}\item 
V\+E\+S\+P\+U\+C\+C\+I\+\_\+\+E\+X\+P\+O\+RT arma\+::vec \hyperlink{namespace_vespucci_1_1_math_1_1_peak_finding_a33b834ac6082132d53ec8b307f16e1bd}{Estimate\+Baseline} (arma\+::vec X, arma\+::umat peaks, arma\+::uword window\+\_\+size)
\begin{DoxyCompactList}\small\item\em Estimate\+Baseline. \end{DoxyCompactList}\item 
V\+E\+S\+P\+U\+C\+C\+I\+\_\+\+E\+X\+P\+O\+RT arma\+::umat \hyperlink{namespace_vespucci_1_1_math_1_1_peak_finding_a502c529617f35fd20d1e11aca2a03a28}{Find\+Peak\+Positions} (arma\+::vec X, arma\+::vec dX, double threshold, std\+::string threshold\+\_\+method, arma\+::vec \&peak\+\_\+magnitudes)
\begin{DoxyCompactList}\small\item\em Vespucci\+::\+Math\+::\+Peak\+Finding\+::\+Find\+Peak\+Positions. \end{DoxyCompactList}\item 
V\+E\+S\+P\+U\+C\+C\+I\+\_\+\+E\+X\+P\+O\+RT arma\+::vec {\bfseries Peak\+Population} (arma\+::uword vector\+\_\+size, arma\+::umat peak\+\_\+positions)\hypertarget{namespace_vespucci_1_1_math_1_1_peak_finding_ab4743c0a36c5000975f1c9f300e101e0}{}\label{namespace_vespucci_1_1_math_1_1_peak_finding_ab4743c0a36c5000975f1c9f300e101e0}

\item 
V\+E\+S\+P\+U\+C\+C\+I\+\_\+\+E\+X\+P\+O\+RT arma\+::vec {\bfseries Peak\+Extrema} (arma\+::uword vector\+\_\+size, arma\+::umat peak\+\_\+positions)\hypertarget{namespace_vespucci_1_1_math_1_1_peak_finding_a2106329f1df30b0aca62ccb130494c88}{}\label{namespace_vespucci_1_1_math_1_1_peak_finding_a2106329f1df30b0aca62ccb130494c88}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
A namespace for math functions relating to peak detection and counting. 

\subsection{Function Documentation}
\index{Vespucci\+::\+Math\+::\+Peak\+Finding@{Vespucci\+::\+Math\+::\+Peak\+Finding}!Estimate\+Baseline@{Estimate\+Baseline}}
\index{Estimate\+Baseline@{Estimate\+Baseline}!Vespucci\+::\+Math\+::\+Peak\+Finding@{Vespucci\+::\+Math\+::\+Peak\+Finding}}
\subsubsection[{\texorpdfstring{Estimate\+Baseline(arma\+::vec X, arma\+::umat peaks, arma\+::uword window\+\_\+size)}{EstimateBaseline(arma::vec X, arma::umat peaks, arma::uword window_size)}}]{\setlength{\rightskip}{0pt plus 5cm}arma\+::vec Vespucci\+::\+Math\+::\+Peak\+Finding\+::\+Estimate\+Baseline (
\begin{DoxyParamCaption}
\item[{arma\+::vec}]{X, }
\item[{arma\+::umat}]{peaks, }
\item[{arma\+::uword}]{window\+\_\+size}
\end{DoxyParamCaption}
)}\hypertarget{namespace_vespucci_1_1_math_1_1_peak_finding_a33b834ac6082132d53ec8b307f16e1bd}{}\label{namespace_vespucci_1_1_math_1_1_peak_finding_a33b834ac6082132d53ec8b307f16e1bd}


Estimate\+Baseline. 


\begin{DoxyParams}{Parameters}
{\em X} & Signal \\
\hline
{\em peaks} & Positions of peaks to exclude from spectrum to calculate baseline \\
\hline
{\em window\+\_\+size} & Size of local minimum filter applied to baseline \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}


Definition at line 351 of file peakfinding.\+cpp.

\index{Vespucci\+::\+Math\+::\+Peak\+Finding@{Vespucci\+::\+Math\+::\+Peak\+Finding}!Find\+Peak\+Positions@{Find\+Peak\+Positions}}
\index{Find\+Peak\+Positions@{Find\+Peak\+Positions}!Vespucci\+::\+Math\+::\+Peak\+Finding@{Vespucci\+::\+Math\+::\+Peak\+Finding}}
\subsubsection[{\texorpdfstring{Find\+Peak\+Positions(arma\+::vec X, arma\+::vec d\+X, double threshold, std\+::string threshold\+\_\+method, arma\+::vec \&peak\+\_\+magnitudes)}{FindPeakPositions(arma::vec X, arma::vec dX, double threshold, std::string threshold_method, arma::vec &peak_magnitudes)}}]{\setlength{\rightskip}{0pt plus 5cm}arma\+::umat Vespucci\+::\+Math\+::\+Peak\+Finding\+::\+Find\+Peak\+Positions (
\begin{DoxyParamCaption}
\item[{arma\+::vec}]{X, }
\item[{arma\+::vec}]{dX, }
\item[{double}]{threshold, }
\item[{std\+::string}]{threshold\+\_\+method, }
\item[{arma\+::vec \&}]{peak\+\_\+magnitudes}
\end{DoxyParamCaption}
)}\hypertarget{namespace_vespucci_1_1_math_1_1_peak_finding_a502c529617f35fd20d1e11aca2a03a28}{}\label{namespace_vespucci_1_1_math_1_1_peak_finding_a502c529617f35fd20d1e11aca2a03a28}


Vespucci\+::\+Math\+::\+Peak\+Finding\+::\+Find\+Peak\+Positions. 


\begin{DoxyParams}{Parameters}
{\em X} & \\
\hline
{\em dX} & A buffered first derivative (same size of X with value of X(i) equal to the derivative of X at i. Taken as a parameter incase a smoothed derivative is to be used \\
\hline
{\em threshold} & A value for threshold of significance. Depending on type \\
\hline
{\em threshold\+\_\+method} & Describes the method to be used (see below) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A arma\+::umat in which each row represents a peak. The first column contains indices of peak centers, the second column contains the left bound of the peak and the third column contains the right bound of the peak. A arma\+::matrix of this forarma\+::mat is the expected input for \hyperlink{namespace_vespucci_1_1_math_1_1_peak_finding_a33b834ac6082132d53ec8b307f16e1bd}{Vespucci\+::\+Math\+::\+Peak\+Finding\+::\+Estimate\+Baseline}. The peak determination may be carried out on a transformed spectra (such as heavy S-\/G smoothing, kernel convolution or C\+WT) then Estimate\+Baseline called with these peak centers and the original spectrum. Estimate\+Baseline will then exclude the larger peaks from the baseline. Since Estimate\+Baseline uses a local minimum filter, smaller peaks will be retained while preventing wider peaks from being cut into by the filter.
\end{DoxyReturn}
threshold\+\_\+method can be the following\+: \char`\"{}magnitude\char`\"{} -\/ a minimum peak-\/height threshold, arbitrary double \char`\"{}count\char`\"{} -\/ maximum number of peaks found, largest magnitude first (1 to many) \char`\"{}countpercentage\char`\"{} -\/ largest percentage of all peaks found (0 to 1) \char`\"{}ratio\char`\"{} -\/ ratio of largest magnitude (0 to 1) 

Definition at line 201 of file peakfinding.\+cpp.

\index{Vespucci\+::\+Math\+::\+Peak\+Finding@{Vespucci\+::\+Math\+::\+Peak\+Finding}!Find\+Peaks@{Find\+Peaks}}
\index{Find\+Peaks@{Find\+Peaks}!Vespucci\+::\+Math\+::\+Peak\+Finding@{Vespucci\+::\+Math\+::\+Peak\+Finding}}
\subsubsection[{\texorpdfstring{Find\+Peaks(arma\+::vec X, arma\+::vec d\+X, double sel, double threshold, arma\+::vec \&peak\+\_\+magnitudes)}{FindPeaks(arma::vec X, arma::vec dX, double sel, double threshold, arma::vec &peak_magnitudes)}}]{\setlength{\rightskip}{0pt plus 5cm}arma\+::vec Vespucci\+::\+Math\+::\+Peak\+Finding\+::\+Find\+Peaks (
\begin{DoxyParamCaption}
\item[{arma\+::vec}]{X, }
\item[{arma\+::vec}]{dX, }
\item[{double}]{sel, }
\item[{double}]{threshold, }
\item[{arma\+::vec \&}]{peak\+\_\+magnitudes}
\end{DoxyParamCaption}
)}\hypertarget{namespace_vespucci_1_1_math_1_1_peak_finding_a3d5687d6ba8babb49689af636f28aae8}{}\label{namespace_vespucci_1_1_math_1_1_peak_finding_a3d5687d6ba8babb49689af636f28aae8}


\hyperlink{namespace_vespucci_1_1_math_1_1_peak_finding_a3d5687d6ba8babb49689af636f28aae8}{Vespucci\+::\+Math\+::\+Peak\+Finding\+::\+Find\+Peaks} an implementation of the peakfinder arma\+::mat routine. 


\begin{DoxyParams}{Parameters}
{\em X} & A vector representing a spectrum \\
\hline
{\em dX} & A first-\/derivative spectrum of X \\
\hline
{\em sel} & The amount above surrounding data for a peak to be identified \\
\hline
{\em threshold} & A threshold value which peaks must be larger than to be maxima \\
\hline
{\em poly\+\_\+order} & The polynomial order of the Savitzky-\/\+Golay filter used for derivatization \\
\hline
{\em window\+\_\+size} & The window size of the Savitzky-\/\+Golay filter used for derivatization \\
\hline
{\em peak\+\_\+locations} & A vector containing one and arma\+::zeros corresponding to whether or not a peak center exists at that wavelength \\
\hline
{\em peak\+\_\+magnitudes} & A vector containing values at peak centers. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}


Definition at line 44 of file peakfinding.\+cpp.

\index{Vespucci\+::\+Math\+::\+Peak\+Finding@{Vespucci\+::\+Math\+::\+Peak\+Finding}!Find\+Peaks\+Mat@{Find\+Peaks\+Mat}}
\index{Find\+Peaks\+Mat@{Find\+Peaks\+Mat}!Vespucci\+::\+Math\+::\+Peak\+Finding@{Vespucci\+::\+Math\+::\+Peak\+Finding}}
\subsubsection[{\texorpdfstring{Find\+Peaks\+Mat(arma\+::mat X, double sel, double threshold, arma\+::uword poly\+\_\+order, arma\+::uword window\+\_\+size, arma\+::mat \&peak\+\_\+magnitudes)}{FindPeaksMat(arma::mat X, double sel, double threshold, arma::uword poly_order, arma::uword window_size, arma::mat &peak_magnitudes)}}]{\setlength{\rightskip}{0pt plus 5cm}arma\+::mat Vespucci\+::\+Math\+::\+Peak\+Finding\+::\+Find\+Peaks\+Mat (
\begin{DoxyParamCaption}
\item[{arma\+::mat}]{X, }
\item[{double}]{sel, }
\item[{double}]{threshold, }
\item[{arma\+::uword}]{poly\+\_\+order, }
\item[{arma\+::uword}]{window\+\_\+size, }
\item[{arma\+::mat \&}]{peak\+\_\+magnitudes}
\end{DoxyParamCaption}
)}\hypertarget{namespace_vespucci_1_1_math_1_1_peak_finding_a9f22a184fb69fb6ab32757fdd19e1ae7}{}\label{namespace_vespucci_1_1_math_1_1_peak_finding_a9f22a184fb69fb6ab32757fdd19e1ae7}


\hyperlink{namespace_vespucci_1_1_math_1_1_peak_finding_a9f22a184fb69fb6ab32757fdd19e1ae7}{Vespucci\+::\+Math\+::\+Peak\+Finding\+::\+Find\+Peaks\+Mat} Performs Find\+Peaks on a spectra arma\+::matrix. 


\begin{DoxyParams}{Parameters}
{\em x} & \\
\hline
{\em sel} & \\
\hline
{\em threshold} & \\
\hline
{\em poly\+\_\+order} & \\
\hline
{\em window\+\_\+size} & \\
\hline
{\em peak\+\_\+locations} & \\
\hline
{\em peak\+\_\+magnitudes} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}


Definition at line 131 of file peakfinding.\+cpp.

